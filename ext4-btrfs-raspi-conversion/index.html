<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.131b48b25a50eff60b34.css">code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><meta name="generator" content="Gatsby 2.23.18"/><style data-styled="" data-styled-version="5.1.1">.dpQIFR{top:0;left:0;margin:0 auto;display:block;width:100%;z-index:1000;background-color:rgba(32,35,42,0.85);font-weight:700;}/*!sc*/
@media (min-width:700px){.dpQIFR{position:fixed;}}/*!sc*/
data-styled.g1[id="Header__HeaderWrapper-sc-1glvhxp-0"]{content:"dpQIFR,"}/*!sc*/
.iIPppa{font-weight:700;margin-left:auto;margin-right:auto;height:60px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;max-width:770px;z-index:1000;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;overflow-x:auto;overflow-y:hidden;white-space:nowrap;padding:0px 20px;}/*!sc*/
data-styled.g2[id="Header__HeaderNav-sc-1glvhxp-1"]{content:"iIPppa,"}/*!sc*/
.kNsALo{display:none;-webkit-box-align:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
@media (min-width:700px){.kNsALo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}/*!sc*/
data-styled.g3[id="Header__HeaderLinksContainer-sc-1glvhxp-2"]{content:"kNsALo,"}/*!sc*/
.elLHjJ{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#ffffff;border:0;margin:0;padding:8px 10px;min-width:42px;z-index:10;}/*!sc*/
.elLHjJ + .Header__HeaderLink-sc-1glvhxp-3{margin-left:0.7rem;}/*!sc*/
data-styled.g4[id="Header__HeaderLink-sc-1glvhxp-3"]{content:"elLHjJ,"}/*!sc*/
.jwglPC{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#ffffff;border:0;margin:0;padding:8px 10px;min-width:42px;z-index:10;padding-left:0;}/*!sc*/
.jwglPC + .Header__HeaderLinkTitle-sc-1glvhxp-4{margin-left:0.7rem;}/*!sc*/
data-styled.g5[id="Header__HeaderLinkTitle-sc-1glvhxp-4"]{content:"jwglPC,"}/*!sc*/
.fbZJYq{display:block;padding-left:0;}/*!sc*/
data-styled.g6[id="Header__HeaderLinkTitleContent-sc-1glvhxp-5"]{content:"fbZJYq,"}/*!sc*/
.kOGoBj{padding:4px;height:57px;}/*!sc*/
data-styled.g7[id="Header__HeaderImage-sc-1glvhxp-6"]{content:"kOGoBj,"}/*!sc*/
.kLFzRf{z-index:30;top:0px;position:relative;color:#ffffff;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background:transparent;border:none;cursor:pointer;padding:8px 12px;outline:none;-webkit-tap-highlight-color:transparent;}/*!sc*/
@media (min-width:700px){.kLFzRf{display:none;}}/*!sc*/
data-styled.g10[id="Header__BurgerButton-sc-1glvhxp-9"]{content:"kLFzRf,"}/*!sc*/
.bbASxq{width:24px;height:2px;background:#ffffff;position:absolute;left:0;background:#ffffff;-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
.bbASxq::before{content:'';top:-8px;width:24px;height:2px;background:#ffffff;position:absolute;left:0;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
.bbASxq::after{top:8px;content:'';width:24px;height:2px;background:white;position:absolute;left:0;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);-webkit-transition:all 250ms cubic-bezier(0.86,0,0.07,1);transition:all 250ms cubic-bezier(0.86,0,0.07,1);}/*!sc*/
data-styled.g11[id="Header__BurgerContent-sc-1glvhxp-10"]{content:"bbASxq,"}/*!sc*/
.cjpVI{text-align:left;padding-top:30px;padding-bottom:50px;background-color:#3E4047;color:#ffffff;padding-left:20px;padding-right:20px;margin:0 auto;}/*!sc*/
.cjpVI nav{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;max-width:900px;margin:0 auto;}/*!sc*/
.cjpVI nav .footer-col{-webkit-flex:1 auto;-ms-flex:1 auto;flex:1 auto;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding-right:1em;}/*!sc*/
.cjpVI a{color:#ffffff;font-weight:bold;}/*!sc*/
.cjpVI a:hover{color:#CFCFD1;}/*!sc*/
.cjpVI .footer-col > p{margin:0;}/*!sc*/
.cjpVI .footer-title{font-size:0.83em;margin:0 0 1rem;}/*!sc*/
.cjpVI .footer-item{color:#ffffff;}/*!sc*/
.cjpVI .footer-item a{padding:0.25rem 0;display:block;}/*!sc*/
.cjpVI .footer-heart{color:red;}/*!sc*/
.cjpVI .footer-item-text{padding:0.1rem 0;color:#ffffff;}/*!sc*/
.cjpVI .footer-header{-webkit-order:1;-ms-flex-order:1;order:1;margin:0 0.25rem;margin-right:0.25rem;padding:0.25rem;}/*!sc*/
.cjpVI .footer-column-items{grid-template-columns:1fr;display:grid;}/*!sc*/
@media (max-width:564px){.cjpVI .footer-col:first-child{width:100%;}}/*!sc*/
data-styled.g12[id="Footer__FooterWrapper-t92llg-0"]{content:"cjpVI,"}/*!sc*/
.kRszmU{display:inline-block;color:#697980;margin:0 4px;}/*!sc*/
.kRszmU::before{content:'‚Ä¢';}/*!sc*/
data-styled.g15[id="Commons__Bull-sc-1aaxjtz-2"]{content:"kRszmU,"}/*!sc*/
.hegtTu{margin:0 0;}/*!sc*/
@media (min-width:700px){.hegtTu{margin:60px 0;}}/*!sc*/
data-styled.g16[id="layout__SiteContent-nrr2ov-0"]{content:"hegtTu,"}/*!sc*/
.fWddfO{position:relative;border-radius:5px;width:80%;max-width:770px;word-wrap:break-word;background-color:#ffffff;margin:0px auto 30px auto;top:30px;padding:50px;box-shadow:0 0 0 0,0 6px 12px rgba(0,0,0,0.1);}/*!sc*/
@media (max-width:780px){.fWddfO{width:100%;padding:25px;}}/*!sc*/
data-styled.g17[id="Wrapper-xmiwfw-0"]{content:"fWddfO,"}/*!sc*/
.dbLdmy{position:relative;display:table;width:100%;height:400px;overflow:hidden;background-repeat:no-repeat;background-position:center;background-size:cover;}/*!sc*/
data-styled.g22[id="Hero__HeroContainer-sc-1wsaguq-0"]{content:"dbLdmy,"}/*!sc*/
.jqsDAr{display:table-cell;vertical-align:middle;text-align:center;width:100%;}/*!sc*/
data-styled.g23[id="Hero__TitleContainer-sc-1wsaguq-1"]{content:"jqsDAr,"}/*!sc*/
.hBxyTz{font-weight:700;font-size:3rem;margin:10px 50px;color:#ffffff;text-shadow:1px 1px 4px rgba(34,34,34,0.85);}/*!sc*/
data-styled.g24[id="Hero__HeroTitle-sc-1wsaguq-2"]{content:"hBxyTz,"}/*!sc*/
.eesUgi{display:inline;color:#697980;}/*!sc*/
data-styled.g26[id="TagList__ListContainer-tgjq80-0"]{content:"eesUgi,"}/*!sc*/
.kqIzSH{text-transform:uppercase;color:#697980;}/*!sc*/
.kqIzSH:not(:first-child){margin-left:0.3rem;}/*!sc*/
.kqIzSH:hover{border-bottom:1px dotted #57595d;}/*!sc*/
.kqIzSH:before{content:'#';}/*!sc*/
data-styled.g27[id="TagList__TagListItemLink-tgjq80-1"]{content:"kqIzSH,"}/*!sc*/
.eOjJiY{text-transform:uppercase;color:#697980;}/*!sc*/
.eOjJiY:not(:first-child){margin-left:0.3rem;}/*!sc*/
.eOjJiY:before{content:'#';}/*!sc*/
data-styled.g28[id="TagList__TagListItem-tgjq80-2"]{content:"eOjJiY,"}/*!sc*/
.fPQfTW .author-image{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;top:-40px;left:50%;margin-left:-40px;width:80px;height:80px;border-radius:100%;overflow:hidden;padding:6px;z-index:2;box-shadow:#ececec 0 0 0 1px;background-color:#ffffff;}/*!sc*/
.fPQfTW .author-image .img{position:relative;display:block;width:100%;height:100%;background-size:cover;background-position:center center;border-radius:100%;}/*!sc*/
.fPQfTW .author-profile .author-image{position:relative;left:auto;top:auto;width:120px;height:120px;padding:3px;margin:-100px auto 0 auto;box-shadow:none;}/*!sc*/
data-styled.g41[id="Bio__BioWrapper-d7fgaq-0"]{content:"fPQfTW,"}/*!sc*/
.cbNTHN{line-height:1.6;margin:1em 0 0 0;}/*!sc*/
.cbNTHN a{box-shadow:0 2px 0 0 #ffdc4e;}/*!sc*/
.cbNTHN a:hover{-webkit-filter:brightness(150%);filter:brightness(150%);box-shadow:none;}/*!sc*/
data-styled.g42[id="Bio__BioText-d7fgaq-1"]{content:"cbNTHN,"}/*!sc*/
.iptoXi{margin-bottom:2rem;color:#57595d;font-size:0.9em;}/*!sc*/
data-styled.g46[id="ContentHeader__Header-sc-1qtxhip-0"]{content:"iptoXi,"}/*!sc*/
.fMKffk{line-height:1.6;}/*!sc*/
.fMKffk > h2{padding-top:3rem;margin-top:3rem;border-top:1px solid #ececec;}/*!sc*/
.fMKffk > h3{padding-top:3rem;}/*!sc*/
.fMKffk > p{margin:1em 0 0 0;}/*!sc*/
.fMKffk a{box-shadow:0 2px 0 0 #ffdc4e;}/*!sc*/
.fMKffk a:hover{-webkit-filter:brightness(150%);filter:brightness(150%);box-shadow:none;}/*!sc*/
.fMKffk a.anchor,.fMKffk a.gatsby-resp-image-link{box-shadow:none;}/*!sc*/
.fMKffk h1 .anchor svg,.fMKffk h2 .anchor svg,.fMKffk h3 .anchor svg,.fMKffk h4 .anchor svg,.fMKffk h5 .anchor svg,.fMKffk h6 .anchor svg{visibility:hidden;margin-left:-16px;}/*!sc*/
.fMKffk h1:hover .anchor svg,.fMKffk h2:hover .anchor svg,.fMKffk h3:hover .anchor svg,.fMKffk h4:hover .anchor svg,.fMKffk h5:hover .anchor svg,.fMKffk h6:hover .anchor svg,.fMKffk h1 .anchor:focus svg,.fMKffk h2 .anchor:focus svg,.fMKffk h3 .anchor:focus svg,.fMKffk h4 .anchor:focus svg,.fMKffk h5 .anchor:focus svg,.fMKffk h6 .anchor:focus svg{visibility:visible;}/*!sc*/
.fMKffk > blockquote{box-sizing:border-box;background-color:#f7f7f7;border-left:5px solid rgb(244,213,36);margin:30px 0px;padding:5px 20px;border-radius:0 8px 8px 0;}/*!sc*/
.fMKffk > blockquote p{margin:0.8em 0;font-style:italic;}/*!sc*/
.fMKffk .gatsby-highlight{border-radius:5px;font-size:15px;line-height:1.7;border-radius:10px;overflow:auto;tab-size:1.5em;margin:1.5em -1.5em;}/*!sc*/
@media (max-width:500px){.fMKffk .gatsby-highlight{border-radius:0;margin-left:-25px;margin-right:-25px;}}/*!sc*/
.fMKffk .gatsby-highlight > pre{border:0;margin:0;padding:1;}/*!sc*/
.fMKffk .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;}/*!sc*/
.fMKffk .gatsby-highlight-code-line{background-color:#022a4b;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:0.75em;border-left:0.25em solid #ffdc4e;}/*!sc*/
.fMKffk h1 > code.language-text,.fMKffk h2 > code.language-text,.fMKffk h3 > code.language-text,.fMKffk h4 > code.language-text,.fMKffk h5 > code.language-text,.fMKffk h6 > code.language-text,.fMKffk a > code.language-text,.fMKffk p > code.language-text,.fMKffk li > code.language-text,.fMKffk em > code.language-text,.fMKffk strong > code.language-text{background:#fff9d9;color:#222222cc;padding:0 3px;font-size:0.94em;border-radius:0.3rem;word-wrap:break-word;}/*!sc*/
.fMKffk code{word-wrap:break-word;}/*!sc*/
.fMKffk table{margin-top:1em;border-collapse:collapse;border-radius:0.5em;overflow:hidden;}/*!sc*/
.fMKffk table th,.fMKffk table td{padding:0.5em;background:#f7f7f7;border-bottom:2px solid #ffffff;}/*!sc*/
data-styled.g47[id="Content__ContentBody-p0bolz-0"]{content:"fMKffk,"}/*!sc*/
.cjwPUL{padding:0 30px 30px;}/*!sc*/
@media only screen and (max-width:500px){.cjwPUL{padding:0;}}/*!sc*/
data-styled.g48[id="Article__ArticleWrapper-jwdbi9-0"]{content:"cjwPUL,"}/*!sc*/
.bgRibg{position:relative;margin:6rem 0 0;padding:3rem 0 0;border-top:1px solid #ececec;}/*!sc*/
data-styled.g49[id="Article__ArticleFooter-jwdbi9-1"]{content:"bgRibg,"}/*!sc*/
.hTzgna{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:770px;width:80%;margin:0px auto 30px auto;top:20px;position:relative;}/*!sc*/
@media (max-width:780px){.hTzgna{width:100%;padding:25px;}}/*!sc*/
data-styled.g50[id="PrevNextPost__PreviewContainer-sc-1r1qyep-0"]{content:"hTzgna,"}/*!sc*/
.idbZOY{cursor:pointer;-webkit-flex:1 1 300px;-ms-flex:1 1 300px;flex:1 1 300px;background-color:#ffffff;box-shadow:0 0 0 0,0 6px 12px rgba(0,0,0,0.1);margin:20px 20px;border-radius:5px;}/*!sc*/
.idbZOY:hover{box-shadow:0 0 0 0,0 6px 12px #B2B3B5;-webkit-transition:all 0.3s ease;transition:all 0.3s ease;-webkit-transform:translate3D(0,-1px,0);-ms-transform:translate3D(0,-1px,0);transform:translate3D(0,-1px,0);}/*!sc*/
@media (min-width:780px){.idbZOY:first-child{margin-left:0;}.idbZOY:last-child{margin-right:0;}}/*!sc*/
data-styled.g51[id="PrevNextPost__Preview-sc-1r1qyep-1"]{content:"idbZOY,"}/*!sc*/
.lanPji{width:auto;height:200px;background:#c5d2d9 no-repeat 50%;background-size:cover;border-radius:5px 5px 0 0;}/*!sc*/
data-styled.g52[id="PrevNextPost__PreviewCover-sc-1r1qyep-2"]{content:"lanPji,"}/*!sc*/
.enysgX{padding:20px;}/*!sc*/
.enysgX header{padding:0 0 10px 0;}/*!sc*/
.enysgX section{padding-bottom:10px;}/*!sc*/
.enysgX footer{font-size:0.8em;}/*!sc*/
data-styled.g53[id="PrevNextPost__PreviewContent-sc-1r1qyep-3"]{content:"enysgX,"}/*!sc*/
*{box-sizing:border-box;margin:0;padding:0;}/*!sc*/
body{font-family:"Lato",sans-serif;color:#3E4047;background-color:#f4f8fb;}/*!sc*/
img{max-width:100%;height:auto;vertical-align:middle;border:0;}/*!sc*/
a{-webkit-text-decoration:none;text-decoration:none;color:#3E4047;}/*!sc*/
hr{border:0;border-top:1px solid #ECECED;margin:50px 0 5px 0;}/*!sc*/
ul,ol{padding-left:2em;margin:1em 0 0 0;}/*!sc*/
*::selection{background-color:#ffdc4e;}/*!sc*/
data-styled.g55[id="sc-global-aBoXv1"]{content:"sc-global-aBoXv1,"}/*!sc*/
.joXPMq{text-transform:uppercase;color:#697980;}/*!sc*/
data-styled.g56[id="Commons__ReadingTimeContainer-sc-1aaxjtz-3"]{content:"joXPMq,"}/*!sc*/
.eWatVx{color:#697980;}/*!sc*/
data-styled.g57[id="Time__TimeContainer-sc-1u6vd0l-0"]{content:"eWatVx,"}/*!sc*/
</style><title data-react-helmet="true">Converting the Raspberry Pi rootfs to btrfs on Ubuntu 18.04 | ifiht-blog</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Lato:400,700&amp;display=swap" rel="stylesheet"/><link data-react-helmet="true" rel="canonical" href="https://ifiht.github.io/ext4-btrfs-raspi-conversion"/><meta data-react-helmet="true" name="description" content="Many guides already exist for configuring a raspberry pi root partition to use btrfs, however there were a few circumstances that basically‚Ä¶"/><meta data-react-helmet="true" property="og:url" content="https://ifiht.github.io/ext4-btrfs-raspi-conversion"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Converting the Raspberry Pi rootfs to btrfs on Ubuntu 18.04 | ifiht-blog"/><meta data-react-helmet="true" property="og:description" content="Many guides already exist for configuring a raspberry pi root partition to use btrfs, however there were a few circumstances that basically‚Ä¶"/><meta data-react-helmet="true" property="og:image" content="https://ifiht.github.io/static/b0da2248b1bc007273f727c44ff9c9cf/spirit_of_java_by_meganerid.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="abcdef"/><meta data-react-helmet="true" name="twitter:title" content="Converting the Raspberry Pi rootfs to btrfs on Ubuntu 18.04 | ifiht-blog"/><meta data-react-helmet="true" name="twitter:description" content="Many guides already exist for configuring a raspberry pi root partition to use btrfs, however there were a few circumstances that basically‚Ä¶"/><meta data-react-helmet="true" name="twitter:image" content="https://ifiht.github.io/static/b0da2248b1bc007273f727c44ff9c9cf/spirit_of_java_by_meganerid.jpg"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="icon" href="/favicon-32x32.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#222222"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a48c3f580f03a9b6b175c59afd67309a"/><link as="script" rel="preload" href="/webpack-runtime-9fea15b14f87fa911d8f.js"/><link as="script" rel="preload" href="/framework-95b680cb3190aa9bfe59.js"/><link as="script" rel="preload" href="/app-a6b88606e98dc37f6ab3.js"/><link as="script" rel="preload" href="/styles-c2fe8482057191dca484.js"/><link as="script" rel="preload" href="/3a2f1ab89072400eb78a258db61265f1964eff8a-b73f091d9871bffaedc3.js"/><link as="script" rel="preload" href="/6dae301c9709e8c5899acc3516b7dd8f43382179-95090f7454fe074ebf89.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-acf1cdf3ef96415e1603.js"/><link as="fetch" rel="preload" href="/page-data/ext4-btrfs-raspi-conversion/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="Header__HeaderWrapper-sc-1glvhxp-0 dpQIFR"><nav class="Header__HeaderNav-sc-1glvhxp-1 iIPppa"><a aria-label="View home page" class="Header__HeaderLink-sc-1glvhxp-3 Header__HeaderLinkTitle-sc-1glvhxp-4 jwglPC" href="/"><img src="/static/a48c3f580f03a9b6b175c59afd67309a/1b595/ivy-icon.png" alt="ifiht-blog" class="Header__HeaderImage-sc-1glvhxp-6 kOGoBj"/><span class="Header__HeaderLinkTitleContent-sc-1glvhxp-5 fbZJYq">ifiht-blog</span></a><div class="Header__HeaderLinksContainer-sc-1glvhxp-2 kNsALo"><a aria-label="View Blog page" class="Header__HeaderLink-sc-1glvhxp-3 elLHjJ" href="/">Blog</a><a aria-label="View About page" class="Header__HeaderLink-sc-1glvhxp-3 elLHjJ" href="/about-gatsby-starter-morning-dew">About</a><a aria-label="View Installation page" class="Header__HeaderLink-sc-1glvhxp-3 elLHjJ" href="/how-to-install">Installation</a></div><button aria-label="open menu" class="Header__BurgerButton-sc-1glvhxp-9 kLFzRf"><div class="Header__BurgerContent-sc-1glvhxp-10 bbASxq"></div></button></nav></header><div class="layout__SiteContent-nrr2ov-0 hegtTu"><div style="background-image:url(&quot;/static/b0da2248b1bc007273f727c44ff9c9cf/spirit_of_java_by_meganerid.jpg&quot;)" class="Hero__HeroContainer-sc-1wsaguq-0 dbLdmy"><div class="Hero__TitleContainer-sc-1wsaguq-1 jqsDAr"><h1 class="Hero__HeroTitle-sc-1wsaguq-2 hBxyTz">Converting the Raspberry Pi rootfs to btrfs on Ubuntu 18.04</h1></div></div><main role="main" class="Wrapper-xmiwfw-0 fWddfO"><article class="Article__ArticleWrapper-jwdbi9-0 cjwPUL"><section><header class="ContentHeader__Header-sc-1qtxhip-0 iptoXi"><time class="Time__TimeContainer-sc-1u6vd0l-0 eWatVx">June 27, 2020</time><span class="Commons__Bull-sc-1aaxjtz-2 kRszmU"></span><div class="TagList__ListContainer-tgjq80-0 eesUgi"><a class="TagList__TagListItemLink-tgjq80-1 kqIzSH" href="/tags/gatsby">gatsby</a>, <a class="TagList__TagListItemLink-tgjq80-1 kqIzSH" href="/tags/ubuntu">ubuntu</a>, <a class="TagList__TagListItemLink-tgjq80-1 kqIzSH" href="/tags/btrfs">btrfs</a></div></header><div class="Content__ContentBody-p0bolz-0 fMKffk"><p>Many guides already exist for configuring a raspberry pi root partition to use btrfs, however there were a few circumstances that basically invalidated all of them:</p><ol><li>I needed the raspberry pi to run Ubuntu 18.04 for my android development,</li><li>The ubuntu image for the pi4 has royally messed with the default /boot volume, and..</li><li>I had to do this all on my Windows laptop, or the pi itself through ssh. </li></ol><p>If for some crazy reason your situation mirrors my own, I hope you find this documentation useful. Feel free to comment below if you have suggestions or improvements to the way I did things üòä</p><p><strong>Formatting the SD card</strong></p><ol><li>I used <a href="https://www.balena.io/etcher/">balenaEtcher</a> to flash the latest pi4-compatible <a href="https://ubuntu.com/download/raspberry-pi">Ubuntu 18.04 64-bit image</a> onto the card.</li><li>Etcher automatically unmounts the card after it‚Äôs finished, so re-mount and use Disk Management (Win + R: <code class="language-text">diskmgmt.msc</code>) to create <em>two</em> partitions. The fist should be the current root partition size (unexpanded) + whatever space you‚Äôd like to add. The second must be formatted <em>without</em> Quick Format, and use all remaining space on the volume.</li><li>Once you‚Äôve created both partitions, delete the first so that the space shows ‚Äúunallocated‚Äù. This will let the pi expand it‚Äôs root partition up to your second placeholder partition.</li><li>Before ejecting the SD card, create a blank file named ‚Äússh‚Äù in the boot partition (the only one that will mount on Windows), and remove the extension. This allows us to ssh into the pi on first boot.</li></ol><p><strong>Starting up the pi</strong></p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">rsync -qaHAXS --exclude={&quot;/dev/*&quot;,&quot;/proc/*&quot;,&quot;/sys/*&quot;,&quot;/tmp/*&quot;,&quot;/run/*&quot;,&quot;/mnt/*&quot;,&quot;/media/*&quot;,&quot;/lost+found&quot;,&quot;boot/firmware/*&quot;} / /mnt/3par

btrfs device add /dev/mmcblk0p2 /

btrfs balance start -mconvert=raid1 /
btrfs balance start -dconvert=raid1 /</code></pre></div><p><strong>Long-Term Stability</strong>
Clone and install <a href="https://github.com/kdave/btrfsmaintenance.git">btrfs maintenance</a>.</p><p><strong>üí°Quick tip:</strong> do NOT use a swap file on root!!!</p></div></section><footer class="Article__ArticleFooter-jwdbi9-1 bgRibg"><div class="Bio__BioWrapper-d7fgaq-0 fPQfTW"><figure class="author-image"><div alt="Michael ____" style="background-image:url(&quot;/static/7c21c56a5f7a9625a11af8c88dbe0f22/497c6/avatar.png&quot;)" class="img"></div></figure><section><h4>About the author</h4><p class="Commons__Text-sc-1aaxjtz-1 Bio__BioText-d7fgaq-1 cbNTHN">
  Michael ____ is a security-conscious, technologically minded carbon-based lifeform seeking efficiency and higher-
  order solutions to a stochastically governed and little-understood universe.
  </p></section></div></footer></article></main><main role="main" class="Wrapper-xmiwfw-0 fWddfO"><div shortname="ifiht-blog" config="[object Object]" id="disqus_thread"></div></main><aside class="PrevNextPost__PreviewContainer-sc-1r1qyep-0 hTzgna"><article class="PrevNextPost__Preview-sc-1r1qyep-1 idbZOY"><a aria-label="View Writing a Gatsby Blog article" href="/writing-this-blog"><div style="background-image:url(&quot;/static/c693e48107bdb95776bf655b4deae751/15300-star-map.jpg&quot;)" class="PrevNextPost__PreviewCover-sc-1r1qyep-2 lanPji"></div><div class="PrevNextPost__PreviewContent-sc-1r1qyep-3 enysgX"><header><h2>Writing a Gatsby Blog</h2></header><section><p>This post serves both to help others duplicate my work, and remind me how I did it myself, if ever I forget. At the bottom I&#x27;ll probably‚Ä¶</p></section><footer><span class="Commons__ReadingTimeContainer-sc-1aaxjtz-3 joXPMq">4<!-- --> min read</span><span class="Commons__Bull-sc-1aaxjtz-2 kRszmU"></span><div class="TagList__ListContainer-tgjq80-0 eesUgi"><span to="/tags/gatsby" class="TagList__TagListItem-tgjq80-2 eOjJiY">gatsby</span>, <span to="/tags/mdx" class="TagList__TagListItem-tgjq80-2 eOjJiY">mdx</span></div></footer></div></a></article><article class="PrevNextPost__Preview-sc-1r1qyep-1 idbZOY"><a aria-label="View Securing Your Website with nftables and Cloudflare article" href="/nftables-cloudflare-secure"><div style="background-image:url(&quot;/static/3da42f9f94e4bf7d1ef5927b43e1347d/ee604/cover-interstellar.png&quot;)" class="PrevNextPost__PreviewCover-sc-1r1qyep-2 lanPji"></div><div class="PrevNextPost__PreviewContent-sc-1r1qyep-3 enysgX"><header><h2>Securing Your Website with nftables and Cloudflare</h2></header><section><p>nftables is still fairly new, fairly tricky to the uninitiated, and fairly  not present  on StackExchange sites... Since nothing I host ever‚Ä¶</p></section><footer><span class="Commons__ReadingTimeContainer-sc-1aaxjtz-3 joXPMq">1<!-- --> min read</span><span class="Commons__Bull-sc-1aaxjtz-2 kRszmU"></span><div class="TagList__ListContainer-tgjq80-0 eesUgi"><span to="/tags/nftables" class="TagList__TagListItem-tgjq80-2 eOjJiY">nftables</span>, <span to="/tags/firewall" class="TagList__TagListItem-tgjq80-2 eOjJiY">firewall</span>, <span to="/tags/cloudflare" class="TagList__TagListItem-tgjq80-2 eOjJiY">cloudflare</span>, <span to="/tags/security" class="TagList__TagListItem-tgjq80-2 eOjJiY">security</span></div></footer></div></a></article></aside></div><footer class="Footer__FooterWrapper-t92llg-0 cjpVI"><nav><div class="footer-col"><h3 class="footer-title">Michael ____<!-- --> ¬© <!-- -->2020</h3><p class="footer-item-text">Built with<!-- --> <a class="footer-link" href="https://www.gatsbyjs.org">Gatsby</a>.</p><p class="footer-item-text">Theme using<!-- --> <a class="footer-link" href="https://github.com/maxpou/gatsby-starter-morning-dew">gatsby-starter-morning-dew</a>.</p><p class="footer-item-text">Hosted with<!-- --> <span class="footer-heart" role="img" aria-label="Love">‚ù§</span> <!-- -->by<!-- --> <a class="footer-link" href="https://github.com">GitHub</a>.</p></div><div class="footer-col"><h3 class="footer-title">Explore</h3><div class="footer-column-items"><span class="footer-item"><a class="footer-link" href="/">Blog</a></span><span class="footer-item"><a class="footer-link" href="/about-gatsby-starter-morning-dew">About</a></span><span class="footer-item"><a class="footer-link" href="/how-to-install">Installation</a></span></div></div><div class="footer-col"><h3 class="footer-title">Follow the author</h3><div class="footer-column-items"><span class="footer-item"><a class="footer-link" href="https://github.com/Ifiht">GitHub</a></span><span class="footer-item"><a class="footer-link" href="https://ifiht.github.io/">Website</a></span></div></div></nav></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-67868977-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/ext4-btrfs-raspi-conversion";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-a6b88606e98dc37f6ab3.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-0097d26fbd474b34ff9b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-81f404344408c3fc61a1.js"],"component---src-templates-blog-list-template-js":["/component---src-templates-blog-list-template-js-08ecf147d276610effc3.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-acf1cdf3ef96415e1603.js"],"component---src-templates-page-js":["/component---src-templates-page-js-e71a9892dd4af96c7980.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-2b7f79f1ebfd756a8075.js"]};/*]]>*/</script><script src="/component---src-templates-blog-post-js-acf1cdf3ef96415e1603.js" async=""></script><script src="/6dae301c9709e8c5899acc3516b7dd8f43382179-95090f7454fe074ebf89.js" async=""></script><script src="/3a2f1ab89072400eb78a258db61265f1964eff8a-b73f091d9871bffaedc3.js" async=""></script><script src="/styles-c2fe8482057191dca484.js" async=""></script><script src="/app-a6b88606e98dc37f6ab3.js" async=""></script><script src="/framework-95b680cb3190aa9bfe59.js" async=""></script><script src="/webpack-runtime-9fea15b14f87fa911d8f.js" async=""></script></body></html>